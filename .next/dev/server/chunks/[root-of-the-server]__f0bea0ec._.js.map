{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/matthewquezada/boise-lux-realty/app/api/lead/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { Resend } from \"resend\";\n\nexport const runtime = \"nodejs\";\n\nconst resend = new Resend(process.env.RESEND_API_KEY);\n\nexport async function POST(req: Request) {\n  // This log should ALWAYS show when route is hit\n  console.log(\"‚úÖ /api/lead hit\");\n\n  try {\n    const data = await req.json();\n    console.log(\"üì© Lead payload:\", data);\n\n    const apiKey = process.env.RESEND_API_KEY;\n    const to = process.env.LEAD_TO_EMAIL;\n    const from = process.env.LEAD_FROM_EMAIL;\n\n    console.log(\"üîê Env check:\", {\n      hasKey: Boolean(apiKey),\n      to,\n      from,\n    });\n\n    if (!apiKey) {\n      return NextResponse.json(\n        { ok: false, error: \"Missing RESEND_API_KEY\" },\n        { status: 500 }\n      );\n    }\n    if (!to || !from) {\n      return NextResponse.json(\n        { ok: false, error: \"Missing LEAD_TO_EMAIL or LEAD_FROM_EMAIL\" },\n        { status: 500 }\n      );\n    }\n\n    const subject = `New lead ‚Äî ${data?.name ?? \"Unknown\"} (${data?.persona ?? \"?\"})`;\n\n    const result = await resend.emails.send({\n      from,\n      to,\n      subject: \"NEW LEAD\",\n      text: `New Lead\n\nName: ${data?.name ?? \"\"}\nEmail: ${data?.email ?? \"\"}\nPhone: ${data?.phone ?? \"\"}\nPersona: ${data?.persona ?? \"\"}\nTimeline: ${data?.timeline ?? \"\"}\nMessage: ${data?.message ?? \"\"}\n\nSource: ${data?.source ?? \"\"}\nCreated: ${data?.createdAt ?? \"\"}\n`,\n      replyTo: data?.email ? String(data.email) : undefined,\n    });\n\n    console.log(\"‚úÖ Resend result:\", result);\n\n    // If resend returns an error, surface it\n    if ((result as any)?.error) {\n      return NextResponse.json(\n        { ok: false, error: (result as any).error },\n        { status: 500 }\n      );\n    }\n\n    return NextResponse.json({ ok: true, id: (result as any)?.data?.id ?? null });\n  } catch (e: any) {\n    console.error(\"‚ùå /api/lead error:\", e);\n    return NextResponse.json(\n      { ok: false, error: e?.message ?? \"Unknown error\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,MAAM,UAAU;AAEvB,MAAM,SAAS,IAAI,oJAAM,CAAC,QAAQ,GAAG,CAAC,cAAc;AAE7C,eAAe,KAAK,GAAY;IACrC,gDAAgD;IAChD,QAAQ,GAAG,CAAC;IAEZ,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,QAAQ,GAAG,CAAC,oBAAoB;QAEhC,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc;QACzC,MAAM,KAAK,QAAQ,GAAG,CAAC,aAAa;QACpC,MAAM,OAAO,QAAQ,GAAG,CAAC,eAAe;QAExC,QAAQ,GAAG,CAAC,iBAAiB;YAC3B,QAAQ,QAAQ;YAChB;YACA;QACF;QAEA,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,IAAI;gBAAO,OAAO;YAAyB,GAC7C;gBAAE,QAAQ;YAAI;QAElB;QACA,IAAI,CAAC,MAAM,CAAC,MAAM;YAChB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,IAAI;gBAAO,OAAO;YAA2C,GAC/D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,UAAU,CAAC,WAAW,EAAE,MAAM,QAAQ,UAAU,EAAE,EAAE,MAAM,WAAW,IAAI,CAAC,CAAC;QAEjF,MAAM,SAAS,MAAM,OAAO,MAAM,CAAC,IAAI,CAAC;YACtC;YACA;YACA,SAAS;YACT,MAAM,CAAC;;MAEP,EAAE,MAAM,QAAQ,GAAG;OAClB,EAAE,MAAM,SAAS,GAAG;OACpB,EAAE,MAAM,SAAS,GAAG;SAClB,EAAE,MAAM,WAAW,GAAG;UACrB,EAAE,MAAM,YAAY,GAAG;SACxB,EAAE,MAAM,WAAW,GAAG;;QAEvB,EAAE,MAAM,UAAU,GAAG;SACpB,EAAE,MAAM,aAAa,GAAG;AACjC,CAAC;YACK,SAAS,MAAM,QAAQ,OAAO,KAAK,KAAK,IAAI;QAC9C;QAEA,QAAQ,GAAG,CAAC,oBAAoB;QAEhC,yCAAyC;QACzC,IAAK,QAAgB,OAAO;YAC1B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,IAAI;gBAAO,OAAO,AAAC,OAAe,KAAK;YAAC,GAC1C;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,IAAI,AAAC,QAAgB,MAAM,MAAM;QAAK;IAC7E,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,IAAI;YAAO,OAAO,GAAG,WAAW;QAAgB,GAClD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}